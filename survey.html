<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CosmIQ — Survey</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root { --bg:#f7fafc; --card:#ffffff; --text:#1f2a37; --muted:#6b7280; --brand:#3b82f6; --brand-2:#22cc88; --radius:16px; --shadow:0 10px 30px rgba(17,24,39,0.08);} 
        *{box-sizing:border-box} html,body{height:100%} body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:var(--text);background:radial-gradient(900px 500px at 15% 5%, rgba(59,130,246,.08), transparent),radial-gradient(900px 500px at 85% 10%, rgba(34,204,136,.07), transparent),var(--bg);} 
        .container{max-width:940px;margin:0 auto;padding:24px}
        header{display:flex;align-items:center;justify-content:space-between;gap:12px}
        .brand{display:flex;align-items:center;gap:10px;font-weight:800;letter-spacing:.2px;font-size:20px}
        .logo{width:40px;height:40px;display:grid;place-items:center;border-radius:12px;background:linear-gradient(135deg,var(--brand), var(--brand-2));box-shadow:var(--shadow)}
        .nasa-badge{display:inline-flex;align-items:center;gap:8px;background:#ffffff;border:1px solid rgba(17,24,39,.12);border-radius:12px;padding:6px 10px;box-shadow:var(--shadow);font-weight:600;color:var(--text);white-space:nowrap}
        .nasa-badge img{height:20px;width:20px;display:block}
        .card{margin-top:28px;background:var(--card);border:1px solid rgba(17,24,39,.08);border-radius:var(--radius);padding:22px 22px 14px;box-shadow:var(--shadow)}
        .h{margin:0 0 6px 0;font-size:24px;font-weight:800}
        .sub{margin:0 0 12px 0;color:var(--muted)}
        .q{margin:18px 0 8px 0;font-weight:700}
        .options{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:10px}
        .opt{background:#ffffff;border:1px solid rgba(17,24,39,.12);border-radius:12px;padding:12px 14px;cursor:pointer;display:flex;gap:10px;align-items:center;transition:transform .15s ease, border-color .15s ease, box-shadow .15s ease}
        .opt:hover{transform:translateY(-2px);border-color:rgba(17,24,39,.25);box-shadow:0 8px 18px rgba(17,24,39,.08)}
        .opt input{display:none}
        .opt.selected{outline:2px solid var(--brand);border-color:var(--brand);box-shadow:0 10px 20px rgba(59,130,246,.15)}
        .ic{font-size:20px}
        .row{display:flex;gap:10px;flex-wrap:wrap}
        .btn{background:linear-gradient(135deg,var(--brand),var(--brand-2));color:white;border:0;padding:12px 16px;font-weight:700;border-radius:12px;cursor:pointer;box-shadow:0 12px 24px rgba(59,130,246,.25);transition:transform .16s ease, filter .16s ease}
        .btn:hover{transform:translateY(-2px);filter:brightness(1.05)}
        .btn:active{transform:translateY(0);filter:brightness(.95)}
        .btn.primary-focus{padding:14px 18px;box-shadow:0 18px 36px rgba(59,130,246,.35), 0 0 0 6px rgba(59,130,246,.12);animation:pulseGlow 2.4s ease-in-out infinite}
        @keyframes pulseGlow { 0%{box-shadow:0 18px 36px rgba(59,130,246,.35),0 0 0 6px rgba(59,130,246,.12)} 50%{box-shadow:0 22px 44px rgba(59,130,246,.45),0 0 0 10px rgba(59,130,246,.2)} 100%{box-shadow:0 18px 36px rgba(59,130,246,.35),0 0 0 6px rgba(59,130,246,.12)} }
        .muted{color:var(--muted);font-size:13px}
        .footer{display:flex;align-items:center;justify-content:space-between;margin-top:14px}
        @media (max-width:720px){.footer{flex-direction:column;gap:10px;align-items:flex-start}}
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="brand"><div class="logo">🌿</div> CosmIQ</div>
            <div style="display:flex; gap:10px; align-items:center;">
                <a class="nasa-badge" href="https://www.spaceappschallenge.org/" target="_blank" rel="noopener noreferrer">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/e/e5/NASA_logo.svg" alt="NASA"/>
                    Space Apps 2025
                </a>
                <button class="btn primary-focus" onclick="window.location.href='index.html'">⬅ Back to Live AQI</button>
            </div>
        </header>

        <div class="card">
            <div class="h">Quick Survey</div>
            <div class="sub">Answer a few questions to personalize your air quality tips.</div>

            <div id="survey"></div>
            
            <div class="footer">
                <div class="muted">We use your answers to tailor recommendations. You can update preferences later.</div>
                <div class="row">
                    <button class="btn" id="submitBtn">Submit</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Configurable question model — add/modify questions easily
        const QUESTIONS = [
            {
                id: 'persona',
                title: 'Who are you?',
                options: [
                    { key: 'athlete', label: 'Athlete', icon: '🏃' },
                    { key: 'parent', label: 'Parent', icon: '👨‍👩‍👧' },
                    { key: 'elderly', label: 'Elderly', icon: '🧓' },
                    { key: 'asthmatic', label: 'Asthmatic', icon: '💨' },
                    { key: 'curious', label: 'Just curious', icon: '👀' }
                ]
            },
            {
                id: 'outdoor_freq',
                title: 'How often do you spend time outdoors?',
                options: [
                    { key: 'rarely', label: 'Rarely', icon: '🏠' },
                    { key: 'sometimes', label: 'Sometimes', icon: '🚶' },
                    { key: 'daily', label: 'Daily', icon: '🌤️' },
                    { key: 'hours', label: 'Several hours/day', icon: '⏳' }
                ]
            },
            {
                id: 'reaction',
                title: 'How do you react to polluted air?',
                options: [
                    { key: 'none', label: 'No noticeable effects', icon: '🙂' },
                    { key: 'mild', label: 'Mild irritation', icon: '😶‍🌫️' },
                    { key: 'headache', label: 'Headache/fatigue', icon: '🤕' },
                    { key: 'breathing', label: 'Breathing issues', icon: '😮‍💨' }
                ]
            },
            {
                id: 'outdoor_time',
                title: 'When are you usually outdoors?',
                options: [
                    { key: 'morning', label: 'Morning', icon: '🌅' },
                    { key: 'midday', label: 'Midday', icon: '☀️' },
                    { key: 'evening', label: 'Evening', icon: '🌇' },
                    { key: 'night', label: 'Night', icon: '🌙' }
                ]
            }
        ];

        const answers = {};

        function renderSurvey() {
            const root = document.getElementById('survey');
            root.innerHTML = '';
            QUESTIONS.forEach(q => {
                const qEl = document.createElement('div');
                qEl.className = 'q-block';
                qEl.innerHTML = `
                    <div class="q">${q.title}</div>
                    <div class="options" id="opts-${q.id}"></div>
                `;
                root.appendChild(qEl);

                const opts = document.getElementById(`opts-${q.id}`);
                q.options.forEach(opt => {
                    const btn = document.createElement('label');
                    btn.className = 'opt';
                    btn.innerHTML = `
                        <input type="radio" name="${q.id}" value="${opt.key}">
                        <span class="ic">${opt.icon}</span>
                        <span>${opt.label}</span>
                    `;
                    btn.addEventListener('click', () => selectOption(q.id, opt.key, btn));
                    opts.appendChild(btn);
                });
            });
        }

        function selectOption(qid, val, btn) {
            answers[qid] = val;
            const group = document.querySelectorAll(`input[name='${qid}']`);
            group.forEach(i => i.closest('.opt').classList.remove('selected'));
            btn.classList.add('selected');
            btn.querySelector('input').checked = true;
        }

        async function saveAnswers() {
            const payload = {
                answers: { ...answers },
                createdAt: new Date().toISOString(),
                user: 'anonymous'
            };

            // 1) localStorage fallback (always works client-side)
            try {
                const all = JSON.parse(localStorage.getItem('airaware_survey') || '[]');
                all.push(payload);
                localStorage.setItem('airaware_survey', JSON.stringify(all));
            } catch (e) { console.warn('localStorage save failed', e); }

            // 2) OPTIONAL: Firebase/Server — provide instructions, stub for future
            // To enable Firebase, include Firebase SDK and write to Firestore here.
            // Example (pseudo): await firebase.firestore().collection('surveys').add(payload)

            alert('Thank you! Your preferences have been saved.');
            window.location.href = 'landing.html';
        }

        document.addEventListener('DOMContentLoaded', () => {
            renderSurvey();
            document.getElementById('submitBtn').addEventListener('click', () => {
                const unanswered = QUESTIONS.filter(q => !answers[q.id]);
                if (unanswered.length) {
                    alert('Please answer all questions before submitting.');
                    return;
                }
                saveAnswers();
            });
        });
    </script>
</body>
</html>

